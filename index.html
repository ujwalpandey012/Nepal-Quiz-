<!DOCTYPE html>
<html lang="ne">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nepal GK Quiz | Ujwal</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<!-- START SCREEN -->
<div id="startScreen" class="start-screen">
  <div class="start-box">
    <h1>Nepal GK Quiz</h1>
    <p>Secure Online Quiz</p>
    <button class="start-btn" onclick="beginQuiz()">Start Quiz</button>
  </div>
</div>

<!-- QUIZ SCREEN -->
<div id="quizContainer" class="quiz-container hidden">

  <div class="header">
    <h2>üá≥üáµ Nepal General Knowledge Quiz</h2>
    <span id="timer">‚è± 05:00</span>
  </div>

  <form id="quizForm">
    <input type="text" id="playerName" placeholder="Full Name" required>
    <input type="email" id="playerEmail" placeholder="Email" required>

    <div id="questions-wrapper"></div>

    <button type="button" id="submitBtn" onclick="submitQuiz()">Submit Quiz</button>
    <div id="resultBox"></div>
  </form>

</div>

<script>
/* START QUIZ */
function beginQuiz() {
  const start = document.getElementById("startScreen");
  const quiz = document.getElementById("quizContainer");
  start.classList.add("hidden");
  quiz.classList.remove("hidden");       // show quiz
}

/* 11 QUIZ QUESTIONS */
const quizData = [
  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§Æ‡§æ ‡§™‡§π‡§ø‡§≤‡•ã ‡§∞‡•á‡§≤ ‡§∏‡•á‡§µ‡§æ ‡§ï‡§π‡§æ‡§Å ‡§∏‡•Å‡§∞‡•Å ‡§≠‡§Ø‡•ã?", 
    options:["Raxaul ‚Äì Amlekhganj","Birgunj ‚Äì Simara","Janakpur ‚Äì Jaynagar","Biratnagar ‚Äì Rangeli"], 
    correct:"Raxaul ‚Äì Amlekhganj" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§ú‡§≤‡§µ‡§ø‡§¶‡•ç‡§Ø‡•Å‡§§‡•ç ‡§Ü‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•Å‡§® ‡§π‡•ã?", 
    options:["Pharping","Trishuli","Kulekhani","Sunkoshi"], 
    correct:"Pharping" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§¨‡•à‡§Ç‡§ï ‡§ï‡•Å‡§® ‡§π‡•ã?", 
    options:["Nepal Bank Limited","Nepal Rastra Bank","Rastriya Banijya Bank","Agriculture Development Bank"], 
    correct:"Nepal Bank Limited" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§ï‡§π‡§ø‡§≤‡•á ‡§ú‡§æ‡§∞‡•Ä ‡§≠‡§Ø‡•ã?", 
    options:["1948 A.D.","1951 A.D.","1962 A.D.","1990 A.D."], 
    correct:"1948 A.D." },

  { q:"‡§®‡•á‡§™‡§æ‡§≤ UN ‡§ï‡•ã ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§π‡§ø‡§≤‡•á ‡§≠‡§è‡§ï‡•ã ‡§π‡•ã?", 
    options:["1955 A.D.","1950 A.D.","1957 A.D.","1961 A.D."], 
    correct:"1955 A.D." },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•Å‡§® ‡§π‡•ã?", 
    options:["Tribhuvan University","Kathmandu University","Purbanchal University","Mid-Western University"], 
    correct:"Tribhuvan University" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§Æ‡§æ ‡§õ‡§æ‡§Ø‡§æ‡§ô‡•ç‡§ï‡§® ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§®‡•á‡§™‡§æ‡§≤‡•Ä ‡§ö‡§≤‡§ö‡§ø‡§§‡•ç‡§∞ ‡§ï‡•Å‡§® ‡§π‡•ã?", 
    options:["Aama","Satya Harischandra","Maitighar","Harischandra"], 
    correct:"Aama" },

  { q:"‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ø ‡§∏‡§≠‡§æ‡§Æ‡§æ ‡§ï‡§§‡§ø ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡•Å‡§®‡•ç‡§õ‡§®‡•ç?", 
    options:["59","56","60","61"], 
    correct:"59" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§ú‡§®‡§ó‡§£‡§®‡§æ ‡§ï‡§π‡§ø‡§≤‡•á ‡§≠‡§è‡§ï‡•ã ‡§π‡•ã?", 
    options:["1911 A.D.","1941 A.D.","1952 A.D.","1961 A.D."], 
    correct:"1911 A.D." },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§≤‡•á SAARC ‡§ö‡§æ‡§∞‡•ç‡§ü‡§∞ ‡§ï‡§π‡§ø‡§≤‡•á ‡§∏‡§æ‡§á‡§® ‡§ó‡§∞‡•ç‚Äç‡§Ø‡•ã?", 
    options:["8 December 1985","6 January 1984","10 December 1986","1 November 1985"], 
    correct:"8 December 1985" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§Ü‡§®‡•ç‡§§‡§∞‡§ø‡§ï ‡§â‡§°‡§æ‡§® ‡§ï‡§π‡§ø‡§≤‡•á ‡§≠‡§è‡§ï‡•ã ‡§•‡§ø‡§Ø‡•ã?", 
    options:["1950 A.D., Kathmandu‚ÄìSimara","1949 A.D., Kathmandu‚ÄìPokhara","1950 A.D., Kathmandu‚ÄìBiratnagar","1951 A.D., Kathmandu‚ÄìJanakpur"], 
    correct:"1950 A.D., Kathmandu‚ÄìSimara" }
];

/* SHUFFLE */
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}
shuffle(quizData);
quizData.forEach(q=>q.options=shuffle(q.options));

/* DISPLAY QUESTIONS */
const wrapper = document.getElementById("questions-wrapper");
quizData.forEach((item,i)=>{
  const div = document.createElement("div");
  div.classList.add("question");

  let html = `<h3>${i+1}. ${item.q}</h3>`;
  item.options.forEach(opt=>{
    html += `<label><input type="radio" name="q${i}" value="${opt}"> ${opt}</label>`;
  });

  div.innerHTML = html;
  wrapper.appendChild(div);
});

/* TIMER */
let timeLeft = 300;
const timer = document.getElementById("timer");
const countdown = setInterval(()=>{
  const m = Math.floor(timeLeft/60);
  const s = timeLeft%60;
  timer.textContent = `‚è± ${m}:${s.toString().padStart(2,"0")}`;
  timeLeft--;
  if(timeLeft < 0){
    clearInterval(countdown);
    submitQuiz();
  }
},1000);

/* ANTI-CHEAT: auto submit on tab change */
window.onblur = () => {
  submitQuiz();
};

/* SUBMIT QUIZ */
async function submitQuiz(){

  clearInterval(countdown);
  document.getElementById("submitBtn").disabled = true;

  const name  = document.getElementById("playerName").value.trim();
  const email = document.getElementById("playerEmail").value.trim();

  if(!name || !email){
    alert("Enter your name & email!");
    return;
  }

  let score = 0;
  let answersDetailed = [];

  quizData.forEach((q,i)=>{
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    const userAns = sel ? sel.value : "Not answered";
    const correct  = userAns === q.correct;
    if(correct) score++;

    answersDetailed.push({
      question:  q.q,
      user:      userAns,
      correctAns:q.correct,
      correct
    });
  });

  const percent = ((score / quizData.length) * 100).toFixed(2);

  const resultBox = document.getElementById("resultBox");
  resultBox.style.display = "block";
  resultBox.innerHTML = `
    <h3>${name}, your score: ${score}/${quizData.length} (${percent}%)</h3>
    <p>Your answers have been submitted. Check your email for details.</p>
  `;

  // SEND TO GOOGLE SCRIPT (saving + email)
  fetch("https://script.google.com/macros/s/AKfycbwFuCsAeg_IQz0uSkNqo45TyMOf19y11g1yEwOCHbEHjXb4v5CkSim6-rfBEu-flTYgOA/exec", {
    method: "POST",
    mode: "no-cors",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      name,
      email,
      score,
      percent,
      total: quizData.length,
      answersDetailed
    })
  });
}

</script>

</body>
</html>
